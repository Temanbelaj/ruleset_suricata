# =============================================================================
# MALWARE DETECTION RULES (SID: 5000-5999)
# =============================================================================

# Generic Malware Command and Control
alert tcp any any -> any any (msg:"MALWARE C&C Communication Detected"; content:"cmd.exe"; nocase; classtype:trojan-activity; sid:5001; rev:1;)

# Suspicious Executable Download
alert http any any -> $HOME_NET any (msg:"MALWARE Suspicious EXE Download"; http.uri; content:".exe"; nocase; classtype:trojan-activity; sid:5002; rev:1;)

# Botnet Communication
alert tcp any any -> any [6667,6697] (msg:"MALWARE Possible IRC Botnet Activity"; content:"NICK "; nocase; classtype:trojan-activity; sid:5003; rev:1;)

# Suspicious PowerShell Activity
alert http any any -> $HOME_NET any (msg:"MALWARE PowerShell Download Cradle"; http.uri; content:"powershell"; nocase; content:"downloadstring"; nocase; distance:0; within:100; classtype:trojan-activity; sid:5004; rev:1;)

# Base64 Encoded Payload
alert http any any -> $HOME_NET any (msg:"MALWARE Base64 Encoded Payload"; http.request_body; content:"base64"; nocase; classtype:trojan-activity; sid:5005; rev:1;)

# Suspicious Registry Modification
alert tcp any any -> $HOME_NET any (msg:"MALWARE Registry Modification Attempt"; content:"reg add"; nocase; classtype:trojan-activity; sid:5006; rev:1;)

# Ransomware File Extension
alert tcp any any -> $HOME_NET any (msg:"MALWARE Ransomware File Extension"; content:".encrypted"; nocase; classtype:trojan-activity; sid:5007; rev:1;)

# Cryptocurrency Mining Activity
alert tcp any any -> any [4444,8080,8333] (msg:"MALWARE Cryptocurrency Mining Activity"; content:"stratum"; nocase; classtype:trojan-activity; sid:5008; rev:1;)

# Suspicious DNS Request
alert dns any any -> any any (msg:"MALWARE Suspicious DNS Request"; dns.query; content:"dga"; nocase; classtype:trojan-activity; sid:5009; rev:1;)

# Malware Dropper Activity
alert http any any -> $HOME_NET any (msg:"MALWARE Dropper Activity Detected"; http.user_agent; content:"wget"; nocase; classtype:trojan-activity; sid:5010; rev:1;)
