# Ruleset untuk Deteksi Serangan File Upload

# Aturan 1-20: Deteksi ekstensi berbahaya umum
alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".php\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:200; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi EXE"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".exe\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:201; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi ASP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".asp\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:202; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi JSP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jsp\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:203; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi BAT"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".bat\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:204; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi CMD"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".cmd\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:205; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi SH"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".sh\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:206; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PL"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".pl\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:207; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PY"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".py\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:208; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi VBS"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".vbs\""; http_client_body; distance:0; classtype:web-application-attack; within:10; sid:209; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PS1"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".ps1\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:210; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi JAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jar\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:211; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi WAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".war\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:212; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi CGI"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".cgi\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:213; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PHTML"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".phtml\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:214; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PHP3"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".php3\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:215; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PHP4"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".php4\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:216; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PHP5"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".php5\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:217; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi PHAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".phar\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:218; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File Berbahaya - Ekstensi DLL"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".dll\""; http_client_body; distance:0;classtype:web-application-attack; within:10; sid:219; rev:1;)

# Aturan 21-40: Deteksi nama file mencurigakan
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Shell.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"shell.php\"";classtype:web-application-attack; http_client_body; sid:220; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Backdoor.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"backdoor.php\"";classtype:web-application-attack; http_client_body; sid:221; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Admin.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"admin.php\"";classtype:web-application-attack; http_client_body; sid:222; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Upload.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"upload.php\"";classtype:web-application-attack; http_client_body; sid:223; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Test.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"test.php\"";classtype:web-application-attack; http_client_body; sid:224; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Cmd.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"cmd.php\"";classtype:web-application-attack; http_client_body; sid:225; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Exploit.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"exploit.php\"";classtype:web-application-attack; http_client_body; sid:226; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Hack.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"hack.php\"";classtype:web-application-attack; http_client_body; sid:227; rev:1;)

alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Root.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"root.php\""; http_client_body;classtype:web-application-attack; sid:228; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Malware.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"malware.php\"";classtype:web-application-attack; http_client_body; sid:229; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Shell.asp"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"shell.asp\"";classtype:web-application-attack; http_client_body; sid:230; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Backdoor.asp"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"backdoor.asp\"";classtype:web-application-attack; http_client_body; sid:231; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Admin.asp"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"admin.asp\"";classtype:web-application-attack; http_client_body; sid:232; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Cmd.asp"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"cmd.asp\"";classtype:web-application-attack; http_client_body; sid:233; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Exploit.asp"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"exploit.asp\"";classtype:web-application-attack; http_client_body; sid:234; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Shell.exe"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"shell.exe\"";classtype:web-application-attack; http_client_body; sid:235; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Backdoor.exe"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"backdoor.exe\"";classtype:web-application-attack; http_client_body; sid:236; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Trojan.exe"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"trojan.exe\"";classtype:web-application-attack; http_client_body; sid:237; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Malware.exe"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"malware.exe\"";classtype:web-application-attack; http_client_body; sid:238; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Nama Rootkit.exe"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"rootkit.exe\""; http_client_body;classtype:web-application-attack; sid:239; rev:1;)

# Aturan 41-60: Deteksi konten berbahaya dalam file
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"<?php"; http_client_body;classtype:web-application-attack; sid:240; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Eval"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"eval("; http_client_body;classtype:web-application-attack; sid:241; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode System"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"system("; http_client_body;classtype:web-application-attack; sid:242; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Exec"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"exec("; http_client_body;classtype:web-application-attack; sid:243; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Shell_exec"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"shell_exec("; http_client_body;classtype:web-application-attack; sid:244; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Passthru"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"passthru("; http_client_body; sid:245;classtype:web-application-attack; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Base64_decode"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"base64_decode("; http_client_body; sid:246; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode ASP Shell"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"<%"; http_client_body; content:"execute"; http_client_body; sid:247; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode VBScript"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"CreateObject("; http_client_body; sid:248; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Powershell"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"IEX("; http_client_body; sid:249; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Perl"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"#!/usr/bin/perl"; http_client_body; sid:250; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Python"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"#!/usr/bin/python"; http_client_body; sid:251; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Bash"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"#!/bin/bash"; http_client_body; sid:252; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode CMD"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"cmd.exe"; http_client_body; sid:253; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode Java"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"Runtime.getRuntime().exec("; http_client_body; sid:254; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode PHP Obfuscated"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"eval(base64_decode("; http_client_body; sid:255; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode PHP Backdoor"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"phpinfo("; http_client_body; sid:256; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode PHP Reverse Shell"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"fsockopen("; http_client_body; sid:257; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode JSP Shell"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"Runtime.getRuntime().exec("; http_client_body; sid:258; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Kode ASP Command"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"Server.CreateObject("; http_client_body; sid:259; rev:1;classtype:web-application-attack;)

# Aturan 61-80: Deteksi serangan dari jaringan luar
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".php\""; http_client_body; sid:260; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi EXE"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".exe\""; http_client_body; sid:261; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi ASP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".asp\""; http_client_body; sid:262; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi JSP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jsp\""; http_client_body; sid:263; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi BAT"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".bat\""; http_client_body; sid:264; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Nama Shell.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"shell.php\""; http_client_body; sid:265; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Nama Backdoor.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"backdoor.php\""; http_client_body; sid:266; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"<?php"; http_client_body; sid:267; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Kode Eval"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"eval("; http_client_body; sid:268; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Kode System"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"system("; http_client_body; sid:269; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi CMD"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".cmd\""; http_client_body; sid:270; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi SH"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".sh\""; http_client_body; sid:271; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi PL"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".pl\""; http_client_body; sid:272; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi PY"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".py\""; http_client_body; sid:273; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi VBS"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".vbs\""; http_client_body; sid:274; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi PS1"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".ps1\""; http_client_body; sid:275; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi JAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jar\""; http_client_body; sid:276; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi WAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".war\""; http_client_body; sid:277; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi CGI"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".cgi\""; http_client_body; sid:278; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ekstensi PHTML"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".phtml\""; http_client_body; sid:279; rev:1;classtype:web-application-attack;)

# Aturan 81-100: Deteksi serangan dari jaringan lokal
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".php\""; http_client_body; sid:280; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi EXE"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".exe\""; http_client_body; sid:281; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi ASP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".asp\""; http_client_body; sid:282; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi JSP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jsp\""; http_client_body; sid:283; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi BAT"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".bat\""; http_client_body; sid:284; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Nama Shell.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"shell.php\""; http_client_body; sid:285; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Nama Backdoor.php"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"backdoor.php\""; http_client_body; sid:286; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"<?php"; http_client_body; sid:287; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Kode Eval"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"eval("; http_client_body; sid:288; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Kode System"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"system("; http_client_body; sid:289; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi CMD"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".cmd\""; http_client_body; sid:290; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi SH"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".sh\""; http_client_body; sid:291; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi PL"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".pl\""; http_client_body; sid:292; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi PY"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".py\""; http_client_body; sid:293; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi VBS"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".vbs\""; http_client_body; sid:294; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi PS1"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".ps1\""; http_client_body; sid:295; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi JAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jar\""; http_client_body; sid:296; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi WAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".war\""; http_client_body; sid:297; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi CGI"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".cgi\""; http_client_body; sid:298; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ekstensi PHTML"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".phtml\""; http_client_body; sid:299; rev:1;classtype:web-application-attack;)

# Aturan 101-120: Deteksi multiple extensions
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.php\"/"; sid:300; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions EXE"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.exe\"/"; sid:301; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions ASP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.asp\"/"; sid:302; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions JSP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.jsp\"/"; sid:303; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions BAT"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.bat\"/"; sid:304; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions CMD"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.cmd\"/"; sid:305; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions SH"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.sh\"/"; sid:306; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PL"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.pl\"/"; sid:307; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PY"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.py\"/"; sid:308; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions VBS"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.vbs\"/"; sid:309; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PS1"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.ps1\"/"; sid:310; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions JAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.jar\"/"; sid:311; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions WAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.war\"/"; sid:312; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions CGI"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.cgi\"/"; sid:313; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PHTML"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.phtml\"/"; sid:314; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PHP3"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.php3\"/"; sid:315; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PHP4"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.php4\"/"; sid:316; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PHP5"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.php5\"/"; sid:317; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions PHAR"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.phar\"/"; sid:318; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Multiple Extensions DLL"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; pcre:"/filename=\".*\.\w+\.dll\"/"; sid:319; rev:1;classtype:web-application-attack;)

# Aturan 121-140: Deteksi file dengan ukuran mencurigakan
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:320; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File - Ukuran Sangat Kecil"; flow:established,to_server; content:"POST"; http_method; content:"Content-Length:"; http_header; pcre:"/^[0-9]{1,2}$/"; sid:321; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Luar - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:322; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload dari Jaringan Lokal - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:323; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PHP - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".php\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:324; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File EXE - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".exe\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:325; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File ASP - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".asp\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:326; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File JSP - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".jsp\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:327; rev:1;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File BAT - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".bat\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:328; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File CMD - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".cmd\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:329; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File SH - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".sh\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:330; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PL - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".pl\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:331; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PY - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".py\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:332; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File VBS - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".vbs\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:333; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PS1 - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".ps1\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:334; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File JAR - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".jar\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:335; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File WAR - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".war\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:336; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File CGI - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".cgi\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:337; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PHTML - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".phtml\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:338; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File DLL - Ukuran Sangat Besar"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:".dll\""; http_client_body; content:"Content-Length:"; http_header; pcre:"/\d{7,}/"; sid:339; rev:1;classtype:web-application-attack;)

# Aturan 141-160: Deteksi serangan pada skrip upload spesifik
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - upload.php"; flow:established,to_server; content:"POST"; http_method; content:"/upload.php"; http_uri; content:"filename=\""; http_client_body; sid:340; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - fileupload.php"; flow:established,to_server; content:"POST"; http_method; content:"/fileupload.php"; http_uri; content:"filename=\""; http_client_body; sid:341; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - uploader.php"; flow:established,to_server; content:"POST"; http_method; content:"/uploader.php"; http_uri; content:"filename=\""; http_client_body; sid:342; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - admin/upload.php"; flow:established,to_server; content:"POST"; http_method; content:"/admin/upload.php"; http_uri; content:"filename=\""; http_client_body; sid:343; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - uploads.php"; flow:established,to_server; content:"POST"; http_method; content:"/uploads.php"; http_uri; content:"filename=\""; http_client_body; sid:344; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - file_upload.php"; flow:established,to_server; content:"POST"; http_method; content:"/file_upload.php"; http_uri; content:"filename=\""; http_client_body; sid:345; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - upload_file.php"; flow:established,to_server; content:"POST"; http_method; content:"/upload_file.php"; http_uri; content:"filename=\""; http_client_body; sid:346; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - upload_script.php"; flow:established,to_server; content:"POST"; http_method; content:"/upload_script.php"; http_uri; content:"filename=\""; http_client_body; sid:347; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - media/upload.php"; flow:established,to_server; content:"POST"; http_method; content:"/media/upload.php"; http_uri; content:"filename=\""; http_client_body; sid:348; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - imageupload.php"; flow:established,to_server; content:"POST"; http_method; content:"/imageupload.php"; http_uri; content:"filename=\""; http_client_body; sid:349; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - upload.asp"; flow:established,to_server; content:"POST"; http_method; content:"/upload.asp"; http_uri; content:"filename=\""; http_client_body; sid:350; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - fileupload.asp"; flow:established,to_server; content:"POST"; http_method; content:"/fileupload.asp"; http_uri; content:"filename=\""; http_client_body; sid:351; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - uploader.asp"; flow:established,to_server; content:"POST"; http_method; content:"/uploader.asp"; http_uri; content:"filename=\""; http_client_body; sid:352; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - admin/upload.asp"; flow:established,to_server; content:"POST"; http_method; content:"/admin/upload.asp"; http_uri; content:"filename=\""; http_client_body; sid:353; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - uploads.asp"; flow:established,to_server; content:"POST"; http_method; content:"/uploads.asp"; http_uri; content:"filename=\""; http_client_body; sid:354; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - upload.jsp"; flow:established,to_server; content:"POST"; http_method; content:"/upload.jsp"; http_uri; content:"filename=\""; http_client_body; sid:355; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - fileupload.jsp"; flow:established,to_server; content:"POST"; http_method; content:"/fileupload.jsp"; http_uri; content:"filename=\""; http_client_body; sid:356; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - uploader.jsp"; flow:established,to_server; content:"POST"; http_method; content:"/uploader.jsp"; http_uri; content:"filename=\""; http_client_body; sid:357; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - admin/upload.jsp"; flow:established,to_server; content:"POST"; http_method; content:"/admin/upload.jsp"; http_uri; content:"filename=\""; http_client_body; sid:358; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan pada Skrip Upload - uploads.jsp"; flow:established,to_server; content:"POST"; http_method; content:"/uploads.jsp"; http_uri; content:"filename=\""; http_client_body; sid:359; rev:1;classtype:web-application-attack;)

# Aturan 161-180: Deteksi serangan dengan ekstensi yang diizinkan tetapi konten berbahaya
alert http any any -> any any (msg:"Deteksi Pengunggahan File JPG dengan Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jpg\""; http_client_body; content:"<?php"; http_client_body; sid:360; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PNG dengan Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".png\""; http_client_body; content:"<?php"; http_client_body; sid:361; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File GIF dengan Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".gif\""; http_client_body; content:"<?php"; http_client_body; sid:362; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File JPEG dengan Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jpeg\""; http_client_body; content:"<?php"; http_client_body; sid:363; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File TXT dengan Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".txt\""; http_client_body; content:"<?php"; http_client_body; sid:364; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File DOC dengan Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".doc\""; http_client_body; content:"<?php"; http_client_body; sid:365; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PDF dengan Kode PHP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".pdf\""; http_client_body; content:"<?php"; http_client_body; sid:366; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File JPG dengan Kode ASP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jpg\""; http_client_body; content:"<%"; http_client_body; sid:367; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PNG dengan Kode ASP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".png\""; http_client_body; content:"<%"; http_client_body; sid:368; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File GIF dengan Kode ASP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".gif\""; http_client_body; content:"<%"; http_client_body; sid:369; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PNG dengan Kode JSP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".png\""; http_client_body; content:"Runtime.getRuntime().exec("; http_client_body; sid:371; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File GIF dengan Kode JSP"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".gif\""; http_client_body; content:"Runtime.getRuntime().exec("; http_client_body; sid:372; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File JPG dengan Kode VBS"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jpg\""; http_client_body; content:"CreateObject("; http_client_body; sid:373; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PNG dengan Kode VBS"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".png\""; http_client_body; content:"CreateObject("; http_client_body; sid:374; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File GIF dengan Kode VBS"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".gif\""; http_client_body; content:"CreateObject("; http_client_body; sid:375; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File JPG dengan Kode PS1"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".jpg\""; http_client_body; content:"IEX("; http_client_body; sid:376; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File PNG dengan Kode PS1"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".png\""; http_client_body; content:"IEX("; http_client_body; sid:377; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File GIF dengan Kode PS1"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".gif\""; http_client_body; content:"IEX("; http_client_body; sid:378; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Pengunggahan File TXT dengan Kode PS1"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\""; http_client_body; content:".txt\""; http_client_body; content:"IEX("; http_client_body; sid:379; rev:1;classtype:web-application-attack;)

# Aturan 181-200: Deteksi serangan terbaru dan spesifik (contoh CVE atau pola modern)
alert http any any -> any any (msg:"Deteksi Serangan File Upload Terbaru - CVE-2023-XXXX"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"exploit.txt\""; http_client_body; sid:380; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern Webshell Pattern"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"<?php"; http_client_body; content:"assert("; http_client_body; sid:381; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Obfuscated Modern Shell"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"eval(gzinflate(base64_decode("; http_client_body; sid:382; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - PHP Filter Chain"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"php://filter"; http_client_body; sid:383; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern RCE Attempt"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"system($_GET["; http_client_body; sid:384; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - CVE-2022-XXXX Pattern"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"rce.php\""; http_client_body; sid:385; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern Backdoor"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"preg_replace("; http_client_body; sid:386; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - PHP Session Exploit"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"session_start("; http_client_body; sid:387; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern Command Injection"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"`whoami`"; http_client_body; sid:388; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - CVE-2021-XXXX Pattern"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"shell2021.php\""; http_client_body; sid:389; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern Encoded Payload"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"gzinflate("; http_client_body; sid:390; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern Reverse Shell"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"nc -e"; http_client_body; sid:392; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - CVE-2020-XXXX Pattern"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"exploit2020.php\""; http_client_body; sid:393; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern File Inclusion"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"include($_GET["; http_client_body; sid:394; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern Obfuscated Exec"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"call_user_func("; http_client_body; sid:395; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern Shell Attempt"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"exec($_POST["; http_client_body; sid:396; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - CVE-2019-XXXX Pattern"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"shell2019.php\""; http_client_body; sid:397; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Modern Persistence"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"file_put_contents("; http_client_body; sid:398; rev:1;classtype:web-application-attack;)
alert http any any -> any any (msg:"Deteksi Serangan File Upload - Latest Known Exploit"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition: form-data"; http_client_body; content:"filename=\"latest_exploit.php\""; http_client_body; sid:399; rev:1;classtype:web-application-attack;)
